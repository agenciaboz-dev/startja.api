generator client {
    provider        = "prisma-client-js"
    previewFeatures = ["fullTextSearch", "fullTextIndex"]
}

datasource db {
    provider = "mysql"
    url      = env("DATABASE_URL")
}

model Admin {
    id              Int                 @id @default(autoincrement())
    name            String
    email           String              @unique
    password        String
}

model Customer {
    id              Int                 @id @default(autoincrement())
    name            String
    email           String              @unique
    password        String
    register_date   String
    phone           String
    document        String              @unique
    city            String
    state           String
    
    companies       Company[]
    certificateId   Int                 @unique
    certificate     DigitalCertificate  @relation(fields: [certificateId], references: [id])
}

model Access {
    id              Int                 @id @default(autoincrement())
}

model DigitalCertificate {
    id              Int                 @id @default(autoincrement())
    expiry          String
    certificate     String              @db.Text
    
    customer        Customer?
}

model Product {
    id              Int                 @id @default(autoincrement())
    name            String              
    ncm             String       

    rule            regraTributacao?
}

model Company {
    id              Int                 @id @default(autoincrement())
    type            String
    name            String
    document        String              @unique
    iine            String
    city            String
    state           String
    district        String
    street          String
    adjunct         String
    number          String
    cep             String
    email           String?
    phone           String?
    
    
    
    customerId      Int
    customer        Customer            @relation(fields: [customerId], references: [id])
}

model Natureza {

    id          Int                     @unique @default(autoincrement())
    operation   String
    type        String
    finality    String
    motive      String

    rule        regraTributacao?        @relation(fields: [ruleId],references: [id])
    ruleId      Int?                    @unique
}

model regraTributacao {

    id          Int                     @unique @default(autoincrement())
    uf          String
    icms        String
    cfop        String
    percentage  String
    motive      String
    rate        String
    deferral    String
    cst         String
    cofins      String

    nature      Natureza?
    product     Product                 @relation(fields: [productId],references: [id])
    productId   Int                     @unique


}
